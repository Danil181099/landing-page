<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Training query</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@200&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism.min.css" /> -->
    <link rel="stylesheet" href="prism.min.js">
    <link rel="stylesheet" href="all1.css">
</head>

<body>
    <section class="test">
        <div class="container">
            <div class="tittle">
                MY GOALS

            </div>

            <div class="container">
                <h1 class="tittle_lower">
                    <a href="https://platform.stratascratch.com/coding/10319-monthly-percentage-difference?code_type=1" target="_blank"> Monthly Percentage Difference </a>
                </h1>
                <h2 class="trigger">
                    <p class="br_text ">Expand answer ↓</p>
                </h2>

                <p class="content">
                    <code class="language-sql">
                  with tbl as(
                    select to_char(created_at, 'YYYY-MM') as date,
                    sum(value) as sum_value,
                    lag(sum(value),1) over() as lag_value
                    from sf_transactions
                    group by 1
                    order by date
                  )
                  select 
                    date, 
                    round((sum_value - lag_value)/lag_value*100,2)
                  from tbl
                  order by date
                </code>
                </p>
            </div>

            <div class="container">
                <h1 class="tittle_lower">
                    <a href="https://platform.stratascratch.com/coding/10300-premium-vs-freemium?code_type=1" target="_blank"> Premium vs Freemium </a>
                </h1>
                <h2 class="trigger">
                    <p class="br_text ">Expand answer ↓</p>
                </h2>

                <p class="content">
                    <code class="language-sql">
                        select *
                        FROM ( SELECT 
                        down.date,
                        SUM(CASE
                        WHEN paying_customer = 'yes' THEN downloads	
                        END )as counts_payning,
                        SUM(CASE
                        WHEN paying_customer = 'no' THEN downloads	
                        END )as counts_no_payning
                        from ms_acc_dimension acc
                        join ms_user_dimension users
                        on acc.acc_id = users.acc_id
                        join ms_download_facts down 
                        on down.user_id = users.user_id
                        GROUP BY down.date)x
                        WHERE counts_no_payning > counts_payning
                        order by 1
                </code>
                </p>
            </div>

            <div class="container">
                <h1 class="tittle_lower">
                    <a href="https://platform.stratascratch.com/coding/10319-monthly-percentage-difference?code_type=1" target="_blank"> Monthly Percentage Difference </a>
                </h1>
                <h2 class="trigger">
                    <p class="br_text ">Expand answer↓</p>
                </h2>

                <p class="content">
                    <code class="language-sql">
                  with tbl as(
                    select to_char(created_at, 'YYYY-MM') as date,
                    sum(value) as sum_value,
                    lag(sum(value),1) over() as lag_value
                    from sf_transactions
                    group by 1
                    order by date
                  )
                  select 
                    date, 
                    round( (sum_value - lag_value)/lag_value*100,2)
                  from tbl
                  order by date
                </code>
                </p>
            </div>

            <div class="container">
                <h1 class="tittle_lower">
                    <a href="https://platform.stratascratch.com/coding/10319-monthly-percentage-difference?code_type=1" target="_blank"> Monthly Percentage Difference </a>
                </h1>
                <h2 class="trigger">
                    <p class="br_text ">Expand answer ↓</p>
                </h2>

                <p class="content">
                    <code class="language-sql">
                  with tbl as(
                    select to_char(created_at, 'YYYY-MM') as date,
                    sum(value) as sum_value,
                    lag(sum(value),1) over() as lag_value
                    from sf_transactions
                    group by 1
                    order by date
                  )
                  select 
                    date, 
                    round( (sum_value - lag_value)/lag_value*100,2)
                  from tbl
                  order by date
                </code>
                </p>
            </div>




            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
            <script src="script.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/components/prism-sql.min.js"></script>
</body>

</html>